# 2.3

无论是从链接的角度还是从执行的角度看待ELF文件，ELF都是固定且唯一的。ELF文件的头部存放着很重要的一些信息，简单分类而言，可是分为三类： 当前系统信息，程序头表及其相关和节头表及其相关。由于Linux不同的发行版，其内部架构也有些许的不同，以我现在自用的ArchLinux（5.12.3.arch1-1）为例，对于ELF文件数据结构的定义，放在/usr/include/elf.h文件中，由于32位的ELF文件与64位的LEF文件并没有太大的差异，故本文的内容皆以64位为例，下面这张图展示了其对于ELF文件头部的数据结构定义。
One Picture

## 2.3.1 当前系统信息

e_ident中定义了ELF文件的魔数（Magic Number）以及一些其他的相关信息，以下为e_ident这个数组的各个索引对应的信息
OnePicture
前三个字节，也就是索引0到索引5,其内容是ELF文件的标识，证明这是一个ELF文件，具体的解释看下图，任何一个ELF文件这四个字节都完全相同
OnePicture
第四个字节表示ELF格式, 1表示为32位，2表示为64位
OnePicture
第五个字节表示数据编码格式,1:小端模式 2:大端模式
OnePicture
第六个字节表示文件版本,该值目前必须为1
OnePicture
e_type定义该ELF文件的文件类型，值为1表示其位可重定位文件，值为2表示其为可执行文件，值为3标识其为共享目标文件，值为4标识其为Core文件（转储格式）
OnePicture
e_machine定义该文件的目标平台架构，常见的62表示x86_64,183表示AARCH64,40表示ARM, 3表示i386
OnePicture
e_version定义对象文件的版本
OnePicture
e_flags定义了与处理器相关的特定的标识为，常见的，如果是Intel结构的，那么它的值就是1

## 2.3.2 程序头表及其信息

e_entry定义可执行文件执行时的入口地址
e_phoff定义程序头表在该ELF文件中的偏移量
e_ehsize定义了ELF头部的长度，单位是字节
e_phnum定义了程序头表中段的数量，通过e_ehsize和e_ephnum这两个值，可以得到程序头表的长度

## 2.3.3 节头表及其信息

e_shoff定义节头表在该ELF文件中的偏移量
e_shentisize定义了节头表中每一节的大小
e_shnum定义了节头表中节的数量，和程序头表类似，可以通过节的数量和大小来计算得到程序头表的大小
e_shstrndx定义节名字符串表在节头表中的索引
